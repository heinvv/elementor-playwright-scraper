export const IN_PAGE_SCRIPT = "// src/in-page-script.ts\nfunction runInPage(payload) {\n  try {\n    let findRuleValue2 = function(cssRules, element, property) {\n      for (let i = cssRules.length - 1; i >= 0; i--) {\n        const cssRule = cssRules[i];\n        if (cssRule.type !== 1) continue;\n        const styleRule = cssRule;\n        try {\n          if (!element.matches(styleRule.selectorText)) continue;\n        } catch {\n          continue;\n        }\n        const val = styleRule.style.getPropertyValue(property);\n        if (val && val.trim() !== \"\") return val.trim();\n      }\n      return null;\n    }, getValueFromSheet2 = function(styleSheet, element, prop) {\n      try {\n        const cssRules = styleSheet.cssRules || styleSheet.rules;\n        if (!cssRules) return null;\n        return findRuleValue2(cssRules, element, prop);\n      } catch {\n        return null;\n      }\n    }, getPropertyFromStylesheets2 = function(element, prop) {\n      const stylesheets = Array.from(document.styleSheets);\n      for (const stylesheet of stylesheets) {\n        const value = getValueFromSheet2(stylesheet, element, prop);\n        if (value) return value;\n      }\n      return null;\n    }, getDimensionWithSource2 = function(element, prop) {\n      const el = element;\n      const inlineStyles = el.style && el.style[prop];\n      if (inlineStyles && String(inlineStyles).trim() !== \"\") {\n        return { value: String(inlineStyles).trim(), source: \"inline\" };\n      }\n      const fromSheet = getPropertyFromStylesheets2(element, prop);\n      if (fromSheet) return { value: fromSheet, source: \"stylesheet\" };\n      const computed = getComputedStyle(element).getPropertyValue(prop);\n      const value = computed && computed !== \"none\" ? computed.trim() : \"\";\n      return { value, source: \"computed\" };\n    }, collectComputedStyles2 = function(element, props) {\n      const computed = getComputedStyle(element);\n      const styles = {};\n      for (let i = 0; i < props.length; i++) {\n        const prop = props[i];\n        const val = computed.getPropertyValue(prop);\n        if (val) styles[prop] = val;\n      }\n      return styles;\n    }, applyDimensionOverrides2 = function(styles, element) {\n      const widthInfo = getDimensionWithSource2(element, \"width\");\n      const heightInfo = getDimensionWithSource2(element, \"height\");\n      if (widthInfo.value) styles[\"width\"] = widthInfo.value;\n      if (heightInfo.value) styles[\"height\"] = heightInfo.value;\n      return {\n        widthSource: widthInfo.value ? widthInfo.source : void 0,\n        heightSource: heightInfo.value ? heightInfo.source : void 0\n      };\n    }, cloneElementWithId2 = function(element, id) {\n      const clone = element.cloneNode(true);\n      clone.setAttribute(\"id\", id);\n      return clone;\n    }, buildElementData2 = function(element, index, accumulatedCount, start, props) {\n      const styles = collectComputedStyles2(element, props);\n      const dimensionSources = applyDimensionOverrides2(styles, element);\n      const generatedId = idPrefix + (start + accumulatedCount);\n      const clone = cloneElementWithId2(element, generatedId);\n      return {\n        index,\n        tagName: element.tagName.toLowerCase(),\n        html: clone.outerHTML,\n        styles,\n        widthSource: dimensionSources.widthSource,\n        heightSource: dimensionSources.heightSource\n      };\n    };\n    var findRuleValue = findRuleValue2, getValueFromSheet = getValueFromSheet2, getPropertyFromStylesheets = getPropertyFromStylesheets2, getDimensionWithSource = getDimensionWithSource2, collectComputedStyles = collectComputedStyles2, applyDimensionOverrides = applyDimensionOverrides2, cloneElementWithId = cloneElementWithId2, buildElementData = buildElementData2;\n    const selector = payload.selector;\n    const startIndex = payload.startIndex;\n    const propertiesList = payload.propertiesList;\n    const idPrefix = payload.idPrefix;\n    const nodes = document.querySelectorAll(selector);\n    const elements = [];\n    for (let i = 0; i < nodes.length; i++) {\n      elements.push(\n        buildElementData2(nodes[i], i, elements.length, startIndex, propertiesList)\n      );\n    }\n    return { selector, elements };\n  } catch (e) {\n    return {\n      selector: payload.selector,\n      elements: [],\n      inPageError: e && e.message ? e.message : String(e)\n    };\n  }\n}; return runInPage(payload);";
